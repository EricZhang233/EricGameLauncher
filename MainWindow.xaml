<Window
    x:Class="EricGameLauncher.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:models="using:EricGameLauncher"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    x:Name="RootWindow">

    <Grid Background="Transparent">
        <Grid.RowDefinitions>
            <RowDefinition Height="48"/>
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        

        
        <Grid Grid.Row="0" Padding="16,0" Background="{ThemeResource LayerFillColorDefaultBrush}" 
              x:Name="TitleBarGrid" Canvas.ZIndex="1000"
              AllowDrop="False">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
                                                
            
            
            <StackPanel Grid.Column="0" 
                        Orientation="Horizontal" 
                        VerticalAlignment="Center"
                        Spacing="12"
                        Margin="0,0,20,0">
                
                <Image x:Name="TitleBarIcon" 
                       Width="32" 
                       Height="32"
                       Stretch="Uniform"/>
                
                <TextBlock Text="EricGameLauncher" 
                           VerticalAlignment="Center" 
                           Style="{ThemeResource BaseTextBlockStyle}"
                           FontSize="18"/>
            </StackPanel>
            
            
            <StackPanel Grid.Column="2" 
                        Orientation="Horizontal" 
                        Spacing="8"
                        VerticalAlignment="Center"
                        Margin="0,0,140,0">
                
                <Button x:Name="SearchButton" 
                        ToolTipService.ToolTip=""
                        CornerRadius="4">
                    <FontIcon Glyph="&#xE721;"/>
                    <Button.Flyout>
                        <Flyout Placement="BottomEdgeAlignedLeft" Opened="SearchFlyout_Opened">
                            <AutoSuggestBox x:Name="SearchBoxFlyout" 
                                            QueryIcon="Find" 
                                            PlaceholderText="" 
                                            Width="280"
                                            TextChanged="SearchBox_TextChanged"/>
                        </Flyout>
                    </Button.Flyout>
                </Button>
                
                
                <Button x:Name="BtnMore" ToolTipService.ToolTip="">
                    <FontIcon Glyph="&#xE712;"/>
                    <Button.Flyout>
                        <MenuFlyout x:Name="MoreMenuFlyout" Placement="BottomEdgeAlignedRight">
                            
                            <MenuFlyoutItem x:Name="MenuIconSizeItem" Text="" Click="MenuIconSize_Click">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xE91B;"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                            
                            <MenuFlyoutSeparator />
                            
                            
                            <MenuFlyoutItem x:Name="MenuAddItem" Text="" Click="BtnAdd_Click">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xE710;"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                            
                            <MenuFlyoutItem x:Name="MenuScanItem" Text="" Click="MenuScan_Click">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xE149;"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                            
                            
                            <MenuFlyoutItem x:Name="MenuSortItem" Text="" Click="MenuSort_Click">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xE70F;"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                            
                            <MenuFlyoutSeparator />
                            
                            
                            <MenuFlyoutSubItem x:Name="MenuSystemIntegrationItem" Text="">
                                <MenuFlyoutSubItem.Icon>
                                    <FontIcon Glyph="&#xE71B;"/>
                                </MenuFlyoutSubItem.Icon>
                                <MenuFlyoutItem x:Name="MenuInstallItem" Text="" Click="MenuInstall_Click">
                                    <MenuFlyoutItem.Icon>
                                        <FontIcon Glyph="&#xE8DA;"/>
                                    </MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>
                                <MenuFlyoutItem x:Name="MenuUninstallItem" Text="" Click="MenuUninstall_Click">
                                    <MenuFlyoutItem.Icon>
                                        <FontIcon Glyph="&#xE894;"/>
                                    </MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>
                            </MenuFlyoutSubItem>

                            <MenuFlyoutItem x:Name="MenuSettingsItem" Text="" Click="MenuSettings_Click">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xE713;"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>

                            <MenuFlyoutItem x:Name="MenuCheckUpdateItem" Text="" Click="MenuCheckUpdate_Click">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xE895;"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                            
                            <MenuFlyoutSeparator />
                            
                            
                            <MenuFlyoutItem Click="AuthorLink_Click">
                                <MenuFlyoutItem.Template>
                                    <ControlTemplate>
                                        <Grid Padding="12,8" Background="Transparent">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                                
                                            
                                            
                                            <Border Grid.Column="0"
                                                    Width="40" 
                                                    Height="40" 
                                                    CornerRadius="8" 
                                                    Background="{ThemeResource LayerFillColorDefaultBrush}"
                                                    VerticalAlignment="Top"
                                                    Margin="0,0,10,0">
                                                <Image x:Name="MenuAuthorIconInternal" 
                                                       Stretch="Uniform" 
                                                       Loaded="MenuAuthorIconInternal_Loaded"
                                                       Margin="4"/>
                                            </Border>
                                            
                                            
                                            <StackPanel Grid.Column="1" 
                                                        Spacing="4" 
                                                        VerticalAlignment="Center">
                                                <TextBlock Text="EricGameLauncher" 
                                                           FontWeight="SemiBold"
                                                           FontSize="12"
                                                           Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                                                <TextBlock x:Name="MenuVersionText"
                                                           FontSize="11"
                                                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                <TextBlock Text="Developed by EricZhang" 
                                                           FontSize="10"
                                                           Margin="0,2,0,0"
                                                           Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                                            </StackPanel>
                                        </Grid>
                                    </ControlTemplate>
                                </MenuFlyoutItem.Template>
                            </MenuFlyoutItem>
                        </MenuFlyout>
                    </Button.Flyout>
                </Button>
            </StackPanel>
            
            
            
            
            <Button x:Name="SizeFlyoutHost" Visibility="Collapsed">
                <Button.Flyout>
                    <Flyout x:Name="SizeFlyout" Placement="Bottom">
                        <StackPanel Width="220" Spacing="8">
                            <TextBlock x:Name="SizeFlyoutTitle" Text="" 
                                       FontSize="14"
                                       FontWeight="SemiBold"/>
                            <Grid ColumnDefinitions="Auto,*,Auto">
                                <TextBlock Grid.Column="0" 
                                           Text="80" 
                                           VerticalAlignment="Center" 
                                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                <Slider x:Name="SizeSlider" 
                                        Grid.Column="1" 
                                        Minimum="80" 
                                        Maximum="200" 
                                        Value="118"
                                        ValueChanged="SizeSlider_ValueChanged"
                                        Margin="8,0"/>
                                <TextBlock Grid.Column="2" 
                                           Text="200" 
                                           VerticalAlignment="Center" 
                                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            </Grid>
                        </StackPanel>
                    </Flyout>
                </Button.Flyout>
            </Button>
            
            
            <Button x:Name="SortFlyoutHost" Visibility="Collapsed">
                <Button.Flyout>
                    <Flyout x:Name="EditOrderFlyout" 
                            Placement="Bottom"
                            Opening="EditOrderFlyout_Opening"
                            Closed="EditOrderFlyout_Closed">
                        <Flyout.FlyoutPresenterStyle>
                            <Style TargetType="FlyoutPresenter">
                                <Setter Property="Padding" Value="0"/>
                                        
                            </Style>
                        </Flyout.FlyoutPresenterStyle>
                        <StackPanel Width="340" Spacing="12" Padding="16">
                            <TextBlock x:Name="SortTitle" Text="" 
                                       FontSize="20"
                                       FontWeight="SemiBold"/>
                            <TextBlock x:Name="SortDescription" Text=""
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                       Style="{ThemeResource CaptionTextBlockStyle}"
                                       TextWrapping="Wrap"/>
                            
                                <ListView x:Name="OrderItemsControl" MaxHeight="400" ScrollViewer.VerticalScrollBarVisibility="Auto" SelectionMode="Single" PreviewKeyDown="OrderList_PreviewKeyDown" ContainerContentChanging="OrderList_ContainerContentChanging">
                                    <ListView.ItemContainerStyle>
                                    <Style TargetType="ListViewItem" BasedOn="{StaticResource DefaultListViewItemStyle}">
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                        <Setter Property="Margin" Value="0,0,0,4"/>
                                        <Setter Property="Padding" Value="0"/>
                                        <Setter Property="CornerRadius" Value="6"/>
                                        <Setter Property="Background" Value="{ThemeResource CardBackgroundFillColorDefaultBrush}"/>
                                        
                                        
                                    </Style>
                                </ListView.ItemContainerStyle>
                                <ListView.Resources>
                                    <SolidColorBrush x:Key="ListViewItemBackgroundSelected" Color="{ThemeResource SystemAccentColorLight2}" Opacity="0.4"/>
                                    <SolidColorBrush x:Key="ListViewItemBackgroundSelectedPointerOver" Color="{ThemeResource SystemAccentColorLight2}" Opacity="0.5"/>
                                    <SolidColorBrush x:Key="ListViewItemBackgroundSelectedPressed" Color="{ThemeResource SystemAccentColorLight2}" Opacity="0.6"/>
                                </ListView.Resources>
                                <ListView.ItemTemplate>
                                        <DataTemplate x:DataType="models:AppItem">
                                            <Grid PointerEntered="OrderItem_PointerEntered" PointerExited="OrderItem_PointerExited">
                                            
                                            <Grid Padding="10">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="32"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                                                                </Grid.ColumnDefinitions>
                                                
                                                
                                                <Border Grid.Column="0" Width="28" Height="28" CornerRadius="6"
                                                        Background="{ThemeResource LayerOnAcrylicFillColorDefaultBrush}">
                                                    <Image Source="{Binding IconPath, Converter={StaticResource ImagePathConverter}, TargetNullValue={x:Null}}" 
                                                           Stretch="Uniform" Margin="2"/>
                                                </Border>
                                                <TextBlock Grid.Column="1" Text="{Binding Title}" 
                                                           VerticalAlignment="Center" Margin="10,0,0,0"
                                                           Style="{ThemeResource BodyTextBlockStyle}"
                                                           TextTrimming="CharacterEllipsis"/>
                                                <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="4" x:Name="SortButtons" Opacity="0">
                                                    <Button Click="BtnMoveUp_Click" Tag="{Binding}" Width="32" Height="32" Padding="0" ToolTipService.ToolTip="">
                                                        <FontIcon Glyph="&#xE70E;" FontSize="12"/>
                                                    </Button>
                                                    <Button Click="BtnMoveDown_Click" Tag="{Binding}" Width="32" Height="32" Padding="0" ToolTipService.ToolTip="">
                                                        <FontIcon Glyph="&#xE70D;" FontSize="12"/>
                                                    </Button>
                                                </StackPanel>
                                            </Grid>
                                        </Grid>
                                    </DataTemplate>
                                    </ListView.ItemTemplate>
                                </ListView>
                            
                        </StackPanel>
                    </Flyout>
                </Button.Flyout>
            </Button>
            
            
            <Button x:Name="SettingsFlyoutHost" Visibility="Collapsed">
                <Button.Flyout>
                    <Flyout x:Name="SettingsFlyout" Placement="Bottom">
                        <StackPanel Spacing="20" MaxWidth="400">
                            <TextBlock x:Name="SettingsTitle" Text="" FontSize="20" FontWeight="SemiBold"/>
                            <StackPanel Spacing="8">
                                <TextBlock x:Name="SettingsGeneralLabel" Text="" FontSize="14" FontWeight="SemiBold"
                                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                <Grid ColumnDefinitions="Auto,*">
                                    <FontIcon Glyph="&#xE774;" FontSize="16"
                                              VerticalAlignment="Center" Margin="0,0,12,0"/>
                                    <ComboBox x:Name="LanguageComboBox" 
                                              Grid.Column="1"
                                              SelectionChanged="LanguageComboBox_SelectionChanged"
                                              HorizontalAlignment="Stretch"/>
                                </Grid>
                                <ToggleSwitch x:Name="ToggleCloseAfterLaunch" 
                                              Header="" 
                                              Toggled="ToggleCloseAfterLaunch_Toggled"/>
                            </StackPanel>
                            <MenuFlyoutSeparator />
                            <StackPanel Spacing="8">
                                <TextBlock x:Name="SettingsDataLocationLabel" Text="" FontSize="14" FontWeight="SemiBold"
                                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                
                                <Grid Margin="0,4,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="12"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="8"/>
                                        <ColumnDefinition Width="Auto"/>
                                                                                    </Grid.ColumnDefinitions>
                                                
                                    <TextBlock x:Name="StorageModeText" 
                                               Grid.Column="0"
                                               Text="" 
                                               VerticalAlignment="Center"
                                               FontWeight="SemiBold"/>
                                    <Button x:Name="BtnSwitchStorageMode" 
                                            Grid.Column="2"
                                            Click="BtnSwitchStorageMode_Click"
                                            Padding="8,4">
                                        <StackPanel Orientation="Horizontal" Spacing="4">
                                            <FontIcon Glyph="&#xE8AB;" FontSize="12"/>
                                            <TextBlock x:Name="SwitchStorageModeText" Text="" VerticalAlignment="Center" FontSize="12"/>
                                        </StackPanel>
                                    </Button>
                                    <Button x:Name="BtnOpenConfigFolder"
                                            Grid.Column="4"
                                            Click="BtnOpenFolder_Click"
                                            Padding="8,4"
                                            ToolTipService.ToolTip="">
                                        <FontIcon Glyph="&#xE8DA;" FontSize="12"/>
                                    </Button>
                                </Grid>
                                
                                <TextBlock x:Name="StoragePathText" 
                                           Text=""
                                           Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                                           Style="{ThemeResource CaptionTextBlockStyle}" 
                                           TextWrapping="Wrap"
                                           IsTextSelectionEnabled="True"/>
                                
                                <TextBlock x:Name="SettingsMigrateNote" Text="" 
                                           Foreground="{ThemeResource TextFillColorTertiaryBrush}" 
                                           Style="{ThemeResource CaptionTextBlockStyle}" TextWrapping="Wrap"/>
                            </StackPanel>
                        </StackPanel>
                    </Flyout>
                </Button.Flyout>
            </Button>
            
            
            <StackPanel Grid.Column="2" 
                        Orientation="Horizontal" 
                        VerticalAlignment="Bottom" 
                        HorizontalAlignment="Right"
                        Margin="0,0,8,4" 
                        Spacing="4"
                        Opacity="0.6">
                <FontIcon x:Name="UpdateSyncIcon"
                          Glyph="&#xE117;" 
                          FontSize="10" 
                          Foreground="{Binding UpdateIndicatorColor, ElementName=RootWindow}"
                          Visibility="{Binding HasUpdate, ElementName=RootWindow, Converter={StaticResource BoolToVisibilityConverter}}"/>
                <TextBlock x:Name="VersionText"
                           Foreground="{Binding UpdateIndicatorColor, ElementName=RootWindow}"
                           FontSize="10"
                           VerticalAlignment="Center"
                           PointerPressed="VersionText_PointerPressed"/>
            </StackPanel>
        </Grid>

        <GridView x:Name="AppGrid" Grid.Row="1" 
                  Padding="20" 
                  SelectionMode="None"
                  CanReorderItems="False"
                  IsItemClickEnabled="True"
                  ItemClick="AppGrid_ItemClick"
                  ContainerContentChanging="AppGrid_ContainerContentChanging">
            <GridView.ItemTemplate>
                <DataTemplate x:DataType="models:AppItem">
                    <StackPanel x:Name="ItemPanel" Width="118" Margin="4" Tag="{Binding}">
                        
                        
                        <Grid x:Name="IconGrid" Width="118" Height="118" Margin="0,0,0,2">
                            
                            <Border x:Name="IconBgBorder" CornerRadius="24" 
                                    Background="{ThemeResource LayerOnAcrylicFillColorDefaultBrush}" 
                                    Opacity="0.5"/>
                            
                            <Border x:Name="IconImgBorder" CornerRadius="21" Margin="6">
                                <Border.Background>
                                    <ImageBrush ImageSource="{Binding IconPath, Converter={StaticResource ImagePathConverter}, TargetNullValue={x:Null}}" 
                                                Stretch="Uniform"/>
                                </Border.Background>
                            </Border>
                            
                            <TextBlock Text="?" 
                                       HorizontalAlignment="Center" 
                                       VerticalAlignment="Center"
                                       FontSize="48"
                                       Opacity="0.3"
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                       Visibility="{Binding IconPath, Converter={StaticResource NullToVisibilityConverter}}"/>
                        </Grid>

                        
                        <TextBlock Text="{Binding Title}" 
                                   x:Name="TitleText"
                                   Width="118"
                                   TextAlignment="Center"
                                   TextTrimming="CharacterEllipsis"
                                   Padding="6,0"
                                   FontSize="12"
                                   FontWeight="SemiBold"
                                   ToolTipService.ToolTip="{Binding Title}"/>

                        <StackPanel.ContextFlyout>
                            <MenuFlyout Opening="ContextMenu_Opening">
                                <MenuFlyoutItem Text="&#36816;&#34892;" Click="MenuRun_Click" Tag="{Binding}" Icon="Play"/>
                                <MenuFlyoutItem Text="&#36816;&#34892;&#31649;&#29702;&#22120;" 
                                                Click="MenuRunMgr_Click" 
                                                Tag="{Binding}"
                                                Icon="Repair"
                                                Visibility="{Binding HasManagerOrDefault, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                <MenuFlyoutSeparator />
                                <MenuFlyoutItem Text="&#25171;&#24320;&#25991;&#20214;&#20301;&#32622;" Click="MenuLoc_Click" Tag="{Binding}" Icon="Folder"/>
                                <MenuFlyoutSeparator />
                                <MenuFlyoutItem Text="&#23646;&#24615;" Click="MenuProp_Click" Tag="{Binding}" Icon="Edit"/>
                                <MenuFlyoutItem Text="&#21024;&#38500;" Click="MenuDel_Click" Tag="{Binding}" Icon="Delete" Foreground="Red"/>
                            </MenuFlyout>
                        </StackPanel.ContextFlyout>
                    </StackPanel>
                </DataTemplate>
            </GridView.ItemTemplate>
        </GridView>

        
        <Grid x:Name="EmptyStatePanel"
              Grid.Row="1"
              Visibility="Collapsed"
              IsHitTestVisible="False"
              Background="Transparent">
            <StackPanel HorizontalAlignment="Center" 
                        VerticalAlignment="Center"
                        Spacing="16">
                <FontIcon Glyph="&#xE838;" 
                          FontSize="64" 
                          Foreground="{ThemeResource TextFillColorTertiaryBrush}"/>
                <TextBlock x:Name="EmptyStateText" Text=""
                           FontSize="16"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                           HorizontalAlignment="Center"/>
            </StackPanel>
        </Grid>

        
        <Grid x:Name="PropertyPanel" 
              Grid.Row="1"
              HorizontalAlignment="Right"
              Width="400"
              Background="{ThemeResource LayerFillColorDefaultBrush}"
              BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
              BorderThickness="1,0,0,0"
              Visibility="Collapsed">
            
            <Grid.Shadow>
                <ThemeShadow />
            </Grid.Shadow>
            
            <Grid RowDefinitions="Auto,*,Auto" Padding="20">
                
                <Grid Grid.Row="0" Margin="0,0,0,16" ColumnDefinitions="*,Auto">
                    <TextBlock Grid.Column="0" x:Name="PropTitleLabel"
                               Text="" 
                               FontSize="20"
                               FontWeight="SemiBold"
                               VerticalAlignment="Center"/>
                    <Button Grid.Column="1"
                            HorizontalAlignment="Right"
                            Click="BtnCloseProperty_Click"
                            Width="32"
                            Height="32"
                            Padding="0"
                            ToolTipService.ToolTip="">
                        <FontIcon Glyph="&#xE711;" FontSize="16"/>
                    </Button>
                </Grid>

                
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <StackPanel Spacing="16">
                        
                        <Grid Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
                              Padding="12" 
                              CornerRadius="8"
                              ColumnDefinitions="Auto,*">
                            
                            <Grid Grid.Column="0" VerticalAlignment="Top" Margin="0,0,12,0">
                                <Border CornerRadius="12" 
                                        Background="{ThemeResource LayerOnAcrylicFillColorDefaultBrush}" 
                                        Width="64" 
                                        Height="64">
                                    <Image x:Name="PropIcon" Stretch="Uniform"/>
                                </Border>
                                <Button VerticalAlignment="Bottom" 
                                        HorizontalAlignment="Right" 
                                        Click="BtnChangeIcon_Click"
                                        Width="24" 
                                        Height="24"
                                        Padding="0"
                                        CornerRadius="12"
                                        ToolTipService.ToolTip="">
                                    <FontIcon Glyph="&#xE8E5;" FontSize="12"/>
                                </Button>
                            </Grid>
                            
                            <StackPanel Grid.Column="1" Spacing="4" VerticalAlignment="Center">
                                <TextBlock x:Name="PropDisplayNameLabel" Text="" 
                                           FontSize="14"
                                           FontWeight="SemiBold"/>
                                <TextBox x:Name="PropTitle" IsSpellCheckEnabled="False" 
                                         InputScope="Default"/>
                            </StackPanel>
                        </Grid>

                        
                        <StackPanel Spacing="8" 
                                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
                                    Padding="12" 
                                    CornerRadius="8">
                            <Grid ColumnDefinitions="*,Auto">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBlock x:Name="PropMainExePathLabel" Text="" 
                                               FontSize="14"
                                               FontWeight="SemiBold"
                                               VerticalAlignment="Center"/>
                                    <Border x:Name="PropPlatformBadgeContainer" 
                                            Background="{ThemeResource AccentFillColorDefaultBrush}"
                                            Padding="6,1"
                                            CornerRadius="4"
                                            VerticalAlignment="Center"
                                            Visibility="Collapsed">
                                        <TextBlock x:Name="PropPlatformBadge" 
                                                   Text="" 
                                                   FontSize="10" 
                                                   Foreground="White"
                                                   FontWeight="Bold"
                                                   VerticalAlignment="Center"/>
                                    </Border>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="4">
                                    <TextBlock x:Name="PropAdminLabel1" Text="" 
                                               FontSize="12" 
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                               VerticalAlignment="Center"/>
                                    <CheckBox x:Name="PropIsAdmin" MinWidth="0" Padding="0" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Grid>
                            <Grid ColumnDefinitions="*,Auto">
                                <TextBox x:Name="PropExePath" IsSpellCheckEnabled="False" 
                                         Grid.Column="0"
                                         InputScope="Default"/>
                                <DropDownButton Grid.Column="1" 
                                                Margin="8,0,0,0" 
                                                ToolTipService.ToolTip="">
                                    <FontIcon Glyph="&#xE8DA;" FontSize="16"/>
                                    <DropDownButton.Flyout>
                                        <MenuFlyout>
                                            <MenuFlyoutSubItem x:Name="MenuExeStartMenu" Text="">
                                                <MenuFlyoutSubItem.Icon>
                                                    <FontIcon Glyph="&#xE700;"/>
                                                </MenuFlyoutSubItem.Icon>
                                            </MenuFlyoutSubItem>
                                            <MenuFlyoutSubItem x:Name="MenuExeDesktop" Text="">
                                                <MenuFlyoutSubItem.Icon>
                                                    <FontIcon Glyph="&#xE8FC;"/>
                                                </MenuFlyoutSubItem.Icon>
                                            </MenuFlyoutSubItem>
                                            <MenuFlyoutSeparator/>
                                            <MenuFlyoutItem x:Name="MenuExeBrowse" Text="" Click="BtnBrowseExe_Click">
                                                <MenuFlyoutItem.Icon>
                                                    <FontIcon Glyph="&#xE8E5;"/>
                                                </MenuFlyoutItem.Icon>
                                            </MenuFlyoutItem>
                                        </MenuFlyout>
                                    </DropDownButton.Flyout>
                                </DropDownButton>
                            </Grid>
                        </StackPanel>

                        <StackPanel Spacing="8" 
                                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
                                    Padding="12" 
                                    CornerRadius="8">
                            <Grid ColumnDefinitions="*,Auto">
                                <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                                    <CheckBox x:Name="PropUseAlternativeLaunch" 
                                              Content=""
                                              MinWidth="0"
                                              VerticalAlignment="Center"/>
                                    <TextBlock x:Name="PropSubstituteExeLabel" Text="" 
                                               FontSize="14"
                                               FontWeight="SemiBold"
                                               VerticalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="4">
                                    <TextBlock x:Name="PropAdminLabel2" Text="" 
                                               FontSize="12" 
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                               VerticalAlignment="Center"/>
                                    <CheckBox x:Name="PropIsAltAdmin" MinWidth="0" Padding="0" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Grid>
                            <Grid ColumnDefinitions="*,Auto">
                                <TextBox x:Name="PropAlternativeLaunchCommand" IsSpellCheckEnabled="False" 
                                         Grid.Column="0"
                                         InputScope="Default"/>
                                <DropDownButton Grid.Column="1" 
                                                Margin="8,0,0,0" 
                                                ToolTipService.ToolTip="">
                                    <FontIcon Glyph="&#xE8DA;" FontSize="16"/>
                                    <DropDownButton.Flyout>
                                        <MenuFlyout>
                                            <MenuFlyoutSubItem x:Name="MenuAltStartMenu" Text="">
                                                <MenuFlyoutSubItem.Icon>
                                                    <FontIcon Glyph="&#xE700;"/>
                                                </MenuFlyoutSubItem.Icon>
                                            </MenuFlyoutSubItem>
                                            <MenuFlyoutSubItem x:Name="MenuAltDesktop" Text="">
                                                <MenuFlyoutSubItem.Icon>
                                                    <FontIcon Glyph="&#xE8FC;"/>
                                                </MenuFlyoutSubItem.Icon>
                                            </MenuFlyoutSubItem>
                                            <MenuFlyoutSeparator/>
                                            <MenuFlyoutItem x:Name="MenuAltBrowse" Text="" Click="BtnBrowseAlt_Click">
                                                <MenuFlyoutItem.Icon>
                                                    <FontIcon Glyph="&#xE8E5;"/>
                                                </MenuFlyoutItem.Icon>
                                            </MenuFlyoutItem>
                                        </MenuFlyout>
                                    </DropDownButton.Flyout>
                                </DropDownButton>
                            </Grid>
                        </StackPanel>

                        <StackPanel Spacing="8" 
                                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
                                    Padding="12" 
                                    CornerRadius="8">
                            <Grid ColumnDefinitions="*,Auto">
                                <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                                    <CheckBox x:Name="PropRunAlongside" 
                                              Content=""
                                              MinWidth="0"
                                              VerticalAlignment="Center"/>
                                    <TextBlock x:Name="PropRunAtLaunchLabel" Text="" 
                                               FontSize="14"
                                               FontWeight="SemiBold"
                                               VerticalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="4">
                                    <TextBlock x:Name="PropAdminLabel3" Text="" 
                                               FontSize="12" 
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                               VerticalAlignment="Center"/>
                                    <CheckBox x:Name="PropIsAlongsideAdmin" MinWidth="0" Padding="0" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Grid>
                            <Grid ColumnDefinitions="*,Auto">
                                <TextBox x:Name="PropAlongsideCommand" IsSpellCheckEnabled="False" 
                                         Grid.Column="0"
                                         InputScope="Default"/>
                                <DropDownButton Grid.Column="1" 
                                                Margin="8,0,0,0" 
                                                ToolTipService.ToolTip="">
                                    <FontIcon Glyph="&#xE8DA;" FontSize="16"/>
                                    <DropDownButton.Flyout>
                                        <MenuFlyout>
                                            <MenuFlyoutSubItem x:Name="MenuAlongStartMenu" Text="">
                                                <MenuFlyoutSubItem.Icon>
                                                    <FontIcon Glyph="&#xE700;"/>
                                                </MenuFlyoutSubItem.Icon>
                                            </MenuFlyoutSubItem>
                                            <MenuFlyoutSubItem x:Name="MenuAlongDesktop" Text="">
                                                <MenuFlyoutSubItem.Icon>
                                                    <FontIcon Glyph="&#xE8FC;"/>
                                                </MenuFlyoutSubItem.Icon>
                                            </MenuFlyoutSubItem>
                                            <MenuFlyoutSeparator/>
                                            <MenuFlyoutItem x:Name="MenuAlongBrowse" Text="" Click="BtnBrowseAlongside_Click">
                                                <MenuFlyoutItem.Icon>
                                                    <FontIcon Glyph="&#xE8E5;"/>
                                                </MenuFlyoutItem.Icon>
                                            </MenuFlyoutItem>
                                        </MenuFlyout>
                                    </DropDownButton.Flyout>
                                </DropDownButton>
                            </Grid>
                        </StackPanel>

                        
                        <StackPanel Spacing="8" 
                                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
                                    Padding="12" 
                                    CornerRadius="8">
                            <Grid ColumnDefinitions="*,Auto,Auto">
                                <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                                    <TextBlock x:Name="PropManagerPathLabel" Text="" 
                                               FontSize="14"
                                               FontWeight="SemiBold"
                                               VerticalAlignment="Center"/>
                                    <TextBlock x:Name="PropOptionalLabel" Text=""
                                               Style="{ThemeResource CaptionTextBlockStyle}"
                                               Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                                               VerticalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="4">
                                    <TextBlock x:Name="PropAdminLabel4" Text="" 
                                               FontSize="12" 
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                               VerticalAlignment="Center"/>
                                    <CheckBox x:Name="PropIsMgrAdmin" MinWidth="0" Padding="0" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Grid>
                            <Grid ColumnDefinitions="*,Auto">
                                <TextBox x:Name="PropMgrPath" IsSpellCheckEnabled="False" 
                                         Grid.Column="0" 
                                         InputScope="Default"/>
                                <DropDownButton Grid.Column="1" 
                                                Margin="8,0,0,0" 
                                                ToolTipService.ToolTip="">
                                    <FontIcon Glyph="&#xE8DA;" FontSize="16"/>
                                    <DropDownButton.Flyout>
                                        <MenuFlyout>
                                            <MenuFlyoutSubItem x:Name="MenuMgrStartMenu" Text="">
                                                <MenuFlyoutSubItem.Icon>
                                                    <FontIcon Glyph="&#xE700;"/>
                                                </MenuFlyoutSubItem.Icon>
                                            </MenuFlyoutSubItem>
                                            <MenuFlyoutSubItem x:Name="MenuMgrDesktop" Text="">
                                                <MenuFlyoutSubItem.Icon>
                                                    <FontIcon Glyph="&#xE8FC;"/>
                                                </MenuFlyoutSubItem.Icon>
                                            </MenuFlyoutSubItem>
                                            <MenuFlyoutSeparator/>
                                            <MenuFlyoutItem x:Name="MenuMgrBrowse" Text="" Click="BtnBrowseMgr_Click">
                                                <MenuFlyoutItem.Icon>
                                                    <FontIcon Glyph="&#xE8E5;"/>
                                                </MenuFlyoutItem.Icon>
                                            </MenuFlyoutItem>
                                        </MenuFlyout>
                                    </DropDownButton.Flyout>
                                </DropDownButton>
                            </Grid>
                        </StackPanel>

                        <TextBlock x:Name="PropCustomMenuLabel" Text="" 
                                   FontSize="14" FontWeight="SemiBold" Margin="0,8,0,-8"/>
                        
                        <StackPanel x:Name="CustomMenuContainer" Spacing="16">

                            <StackPanel x:Name="PropCustomSection1" Spacing="8" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" Padding="12" CornerRadius="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock x:Name="PropCustomSlotLabel1" Text="" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="4">
                                            <TextBlock x:Name="PropCustomAdminLabel1" Text="" 
                                                       FontSize="12" 
                                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                       VerticalAlignment="Center"/>
                                            <CheckBox x:Name="PropCustomAdmin1" MinWidth="0" Padding="0" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Grid>
                                    <TextBox x:Name="PropCustomTitle1" IsSpellCheckEnabled="False"/>
                                <Grid ColumnDefinitions="*,Auto">
                                    <TextBox x:Name="PropCustomCommand1" IsSpellCheckEnabled="False"/>
                                    <DropDownButton Grid.Column="1" Margin="8,0,0,0" x:Name="BtnCustomBrowse1">
                                        <FontIcon Glyph="&#xE8DA;" FontSize="16"/>
                                    </DropDownButton>
                                </Grid>
                            </StackPanel>

                            <StackPanel x:Name="PropCustomSection2" Visibility="Collapsed" Spacing="8" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" Padding="12" CornerRadius="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock x:Name="PropCustomSlotLabel2" Text="" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="4">
                                            <TextBlock x:Name="PropCustomAdminLabel2" Text="" 
                                                       FontSize="12" 
                                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                       VerticalAlignment="Center"/>
                                            <CheckBox x:Name="PropCustomAdmin2" MinWidth="0" Padding="0" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Grid>
                                    <TextBox x:Name="PropCustomTitle2" IsSpellCheckEnabled="False"/>
                                <Grid ColumnDefinitions="*,Auto">
                                    <TextBox x:Name="PropCustomCommand2" IsSpellCheckEnabled="False"/>
                                    <DropDownButton Grid.Column="1" Margin="8,0,0,0" x:Name="BtnCustomBrowse2">
                                        <FontIcon Glyph="&#xE8DA;" FontSize="16"/>
                                    </DropDownButton>
                                </Grid>
                            </StackPanel>

                            <StackPanel x:Name="PropCustomSection3" Visibility="Collapsed" Spacing="8" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" Padding="12" CornerRadius="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock x:Name="PropCustomSlotLabel3" Text="" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="4">
                                            <TextBlock x:Name="PropCustomAdminLabel3" Text="" 
                                                       FontSize="12" 
                                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                       VerticalAlignment="Center"/>
                                            <CheckBox x:Name="PropCustomAdmin3" MinWidth="0" Padding="0" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Grid>
                                    <TextBox x:Name="PropCustomTitle3" IsSpellCheckEnabled="False"/>
                                <Grid ColumnDefinitions="*,Auto">
                                    <TextBox x:Name="PropCustomCommand3" IsSpellCheckEnabled="False"/>
                                    <DropDownButton Grid.Column="1" Margin="8,0,0,0" x:Name="BtnCustomBrowse3">
                                        <FontIcon Glyph="&#xE8DA;" FontSize="16"/>
                                    </DropDownButton>
                                </Grid>
                            </StackPanel>

                            <StackPanel x:Name="PropCustomSection4" Visibility="Collapsed" Spacing="8" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" Padding="12" CornerRadius="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock x:Name="PropCustomSlotLabel4" Text="" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="4">
                                            <TextBlock x:Name="PropCustomAdminLabel4" Text="" 
                                                       FontSize="12" 
                                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                       VerticalAlignment="Center"/>
                                            <CheckBox x:Name="PropCustomAdmin4" MinWidth="0" Padding="0" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Grid>
                                    <TextBox x:Name="PropCustomTitle4" IsSpellCheckEnabled="False"/>
                                <Grid ColumnDefinitions="*,Auto">
                                    <TextBox x:Name="PropCustomCommand4" IsSpellCheckEnabled="False"/>
                                    <DropDownButton Grid.Column="1" Margin="8,0,0,0" x:Name="BtnCustomBrowse4">
                                        <FontIcon Glyph="&#xE8DA;" FontSize="16"/>
                                    </DropDownButton>
                                </Grid>
                            </StackPanel>

                            <StackPanel x:Name="PropCustomSection5" Visibility="Collapsed" Spacing="8" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" Padding="12" CornerRadius="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock x:Name="PropCustomSlotLabel5" Text="" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="4">
                                            <TextBlock x:Name="PropCustomAdminLabel5" Text="" 
                                                       FontSize="12" 
                                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                       VerticalAlignment="Center"/>
                                            <CheckBox x:Name="PropCustomAdmin5" MinWidth="0" Padding="0" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Grid>
                                    <TextBox x:Name="PropCustomTitle5" IsSpellCheckEnabled="False"/>
                                <Grid ColumnDefinitions="*,Auto">
                                    <TextBox x:Name="PropCustomCommand5" IsSpellCheckEnabled="False"/>
                                    <DropDownButton Grid.Column="1" Margin="8,0,0,0" x:Name="BtnCustomBrowse5">
                                        <FontIcon Glyph="&#xE8DA;" FontSize="16"/>
                                    </DropDownButton>
                                </Grid>
                            </StackPanel>

                            <StackPanel x:Name="PropCustomSection6" Visibility="Collapsed" Spacing="8" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" Padding="12" CornerRadius="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock x:Name="PropCustomSlotLabel6" Text="" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="4">
                                            <TextBlock x:Name="PropCustomAdminLabel6" Text="" 
                                                       FontSize="12" 
                                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                       VerticalAlignment="Center"/>
                                            <CheckBox x:Name="PropCustomAdmin6" MinWidth="0" Padding="0" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Grid>
                                    <TextBox x:Name="PropCustomTitle6" IsSpellCheckEnabled="False"/>
                                <Grid ColumnDefinitions="*,Auto">
                                    <TextBox x:Name="PropCustomCommand6" IsSpellCheckEnabled="False"/>
                                    <DropDownButton Grid.Column="1" Margin="8,0,0,0" x:Name="BtnCustomBrowse6">
                                        <FontIcon Glyph="&#xE8DA;" FontSize="16"/>
                                    </DropDownButton>
                                </Grid>
                            </StackPanel>

                            <StackPanel x:Name="PropCustomSection7" Visibility="Collapsed" Spacing="8" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" Padding="12" CornerRadius="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock x:Name="PropCustomSlotLabel7" Text="" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="4">
                                            <TextBlock x:Name="PropCustomAdminLabel7" Text="" 
                                                       FontSize="12" 
                                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                       VerticalAlignment="Center"/>
                                            <CheckBox x:Name="PropCustomAdmin7" MinWidth="0" Padding="0" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Grid>
                                    <TextBox x:Name="PropCustomTitle7" IsSpellCheckEnabled="False"/>
                                <Grid ColumnDefinitions="*,Auto">
                                    <TextBox x:Name="PropCustomCommand7" IsSpellCheckEnabled="False"/>
                                    <DropDownButton Grid.Column="1" Margin="8,0,0,0" x:Name="BtnCustomBrowse7">
                                        <FontIcon Glyph="&#xE8DA;" FontSize="16"/>
                                    </DropDownButton>
                                </Grid>
                            </StackPanel>

                            <StackPanel x:Name="PropCustomSection8" Visibility="Collapsed" Spacing="8" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" Padding="12" CornerRadius="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock x:Name="PropCustomSlotLabel8" Text="" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="4">
                                            <TextBlock x:Name="PropCustomAdminLabel8" Text="" 
                                                       FontSize="12" 
                                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                       VerticalAlignment="Center"/>
                                            <CheckBox x:Name="PropCustomAdmin8" MinWidth="0" Padding="0" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Grid>
                                    <TextBox x:Name="PropCustomTitle8" IsSpellCheckEnabled="False"/>
                                <Grid ColumnDefinitions="*,Auto">
                                    <TextBox x:Name="PropCustomCommand8" IsSpellCheckEnabled="False"/>
                                    <DropDownButton Grid.Column="1" Margin="8,0,0,0" x:Name="BtnCustomBrowse8">
                                        <FontIcon Glyph="&#xE8DA;" FontSize="16"/>
                                    </DropDownButton>
                                </Grid>
                            </StackPanel>

                            <StackPanel x:Name="PropCustomSection9" Visibility="Collapsed" Spacing="8" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" Padding="12" CornerRadius="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock x:Name="PropCustomSlotLabel9" Text="" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="4">
                                            <TextBlock x:Name="PropCustomAdminLabel9" Text="" 
                                                       FontSize="12" 
                                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                       VerticalAlignment="Center"/>
                                            <CheckBox x:Name="PropCustomAdmin9" MinWidth="0" Padding="0" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Grid>
                                    <TextBox x:Name="PropCustomTitle9" IsSpellCheckEnabled="False"/>
                                <Grid ColumnDefinitions="*,Auto">
                                    <TextBox x:Name="PropCustomCommand9" IsSpellCheckEnabled="False"/>
                                    <DropDownButton Grid.Column="1" Margin="8,0,0,0" x:Name="BtnCustomBrowse9">
                                        <FontIcon Glyph="&#xE8DA;" FontSize="16"/>
                                    </DropDownButton>
                                </Grid>
                            </StackPanel>

                            <StackPanel x:Name="PropCustomSection10" Visibility="Collapsed" Spacing="8" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" Padding="12" CornerRadius="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock x:Name="PropCustomSlotLabel10" Text="" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="4">
                                            <TextBlock x:Name="PropCustomAdminLabel10" Text="" 
                                                       FontSize="12" 
                                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                       VerticalAlignment="Center"/>
                                            <CheckBox x:Name="PropCustomAdmin10" MinWidth="0" Padding="0" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Grid>
                                    <TextBox x:Name="PropCustomTitle10" IsSpellCheckEnabled="False"/>
                                <Grid ColumnDefinitions="*,Auto">
                                    <TextBox x:Name="PropCustomCommand10" IsSpellCheckEnabled="False"/>
                                    <DropDownButton Grid.Column="1" Margin="8,0,0,0" x:Name="BtnCustomBrowse10">
                                        <FontIcon Glyph="&#xE8DA;" FontSize="16"/>
                                    </DropDownButton>
                                </Grid>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
                <Grid Grid.Row="2" 
                      Margin="0,16,0,0" 
                      ColumnDefinitions="Auto,*,Auto">
                    <Button x:Name="PropBtnDelete" 
                            Grid.Column="0"
                            Click="BtnDeleteProperty_Click"
                            ToolTipService.ToolTip="">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE74D;" FontSize="16" Foreground="Red"/>
                            <TextBlock x:Name="PropDeleteText" Text="" Foreground="Red" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                    
                    <Button Grid.Column="2"
                            Style="{ThemeResource AccentButtonStyle}" 
                            Click="BtnSaveProperty_Click"
                            ToolTipService.ToolTip="">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE74E;" FontSize="16"/>
                            <TextBlock x:Name="PropSaveText" Text="" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                </Grid>
            </Grid>
        </Grid>

        <Grid x:Name="MigrationOverlay"
              Grid.RowSpan="2"
              Background="{ThemeResource SolidBackgroundFillColorBaseBrush}"
              Visibility="Collapsed"
              Canvas.ZIndex="2000">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="24">
                <ProgressRing Width="64" Height="64" IsActive="True"/>
                <StackPanel Spacing="8">
                    <TextBlock x:Name="MigrationTitle" 
                               Text="" 
                               FontSize="20" 
                               FontWeight="SemiBold" 
                               HorizontalAlignment="Center"/>
                    <TextBlock x:Name="MigrationSubTitle" 
                               Text="" 
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               HorizontalAlignment="Center"/>
                </StackPanel>
            </StackPanel>
        </Grid>
        
        <ContentDialog x:Name="ScannerDialog" 
                       Grid.RowSpan="2"
                       PrimaryButtonText="导入选中的项目" 
                       SecondaryButtonText="导入全部新增项目" 
                       CloseButtonText="取消"
                       PrimaryButtonClick="ScannerDialog_PrimaryButtonClick"
                       SecondaryButtonClick="ScannerDialog_SecondaryButtonClick">
            <Grid MinWidth="450" MinHeight="350">
                <Grid x:Name="ScannerLoadingPanel" VerticalAlignment="Center" HorizontalAlignment="Center">
                    <StackPanel Spacing="16">
                        <ProgressRing Width="48" Height="48" IsActive="True"/>
                        <TextBlock x:Name="ScannerLoadingText" Text="正在扫描本地游戏..." HorizontalAlignment="Center" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                    </StackPanel>
                </Grid>
                
                <ScrollViewer x:Name="ScannerResultPanel" Visibility="Collapsed" MaxHeight="450">
                    <StackPanel Spacing="24" Margin="0,0,12,0">
                        <TextBlock x:Name="ScannerDescriptionText" 
                                   Text="" 
                                   Style="{ThemeResource CaptionTextBlockStyle}" 
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                   TextWrapping="Wrap"/>
                        
                        <StackPanel x:Name="ScannerNewGamesSection">
                            <TextBlock x:Name="ScannerNewGamesHeader" Text="新增" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <ListView x:Name="ScannerNewGamesList" SelectionMode="Multiple" ScrollViewer.VerticalScrollMode="Disabled" ItemContainerStyle="{StaticResource DefaultListViewItemStyle}">
                                <ListView.ItemTemplate>
                                    <DataTemplate x:DataType="models:ScannedGame">
                                        <Grid Margin="0,4">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Column="0" Text="{x:Bind Title}" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                                            <Border Grid.Column="1" Background="{ThemeResource AccentFillColorDefaultBrush}" Padding="6,2" CornerRadius="4" Margin="12,0,0,0">
                                                <TextBlock Text="{x:Bind PlatformBadge}" FontSize="10" Foreground="White" FontWeight="Bold"/>
                                            </Border>
                                        </Grid>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>
                        </StackPanel>
                        
                        <StackPanel x:Name="ScannerExistingGamesSection">
                            <TextBlock x:Name="ScannerExistingGamesHeader" Text="已存在" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <ListView x:Name="ScannerExistingGamesList" SelectionMode="None" ScrollViewer.VerticalScrollMode="Disabled" Opacity="0.6">
                                <ListView.ItemTemplate>
                                    <DataTemplate x:DataType="models:ScannedGame">
                                        <Grid Margin="0,4">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Column="0" Text="{x:Bind Title}" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                                            <Border Grid.Column="1" Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}" BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1" Padding="6,2" CornerRadius="4" Margin="12,0,0,0">
                                                <TextBlock Text="{x:Bind PlatformBadge}" FontSize="10" Foreground="{ThemeResource TextFillColorSecondaryBrush}" FontWeight="SemiBold"/>
                                            </Border>
                                        </Grid>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
                

            </Grid>
        </ContentDialog>
    </Grid>
</Window>

